
<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SparkHub ‚Äì Prot√≥tipo (Single File)</title>
    <!-- Tailwind via CDN (JIT) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React 18 UMD + ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for in-browser JSX transform -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-zinc-50 dark:bg-zinc-900">
    <div id="root"></div>

    <script type="text/babel">
      /** SparkHub ‚Äî React Wireframe (single-file) **/
      const { useEffect, useMemo, useRef, useState } = React;

      // =============== Helpers =====================
      const LS = () => { try { return window?.localStorage || null; } catch { return null; } };
      const persist = (k,v) => { const ls = LS(); try{ ls && ls.setItem(k, v);}catch{} };
      const read = (k, d) => { const ls = LS(); try{ return (ls&&ls.getItem(k)) ?? d; }catch{ return d; } };
      const filterByTags = (items,tags,search) => items.filter(it => {
        const q=(search||"").toLowerCase(); const has=tags&&tags.length;
        return (!q||it.title.toLowerCase().includes(q)) && (!has||it.tags.some(t=>tags.includes(t)));
      });

      // =============== UI Primitives =====================
      const Btn=({variant="default",className="",children,...p})=>{
        const base="h-9 px-3 rounded-xl text-sm inline-flex items-center gap-2 justify-center transition-colors min-w-0";
        const map={
          default:"bg-zinc-900 text-white hover:bg-zinc-800 dark:bg-zinc-100 dark:text-zinc-900 dark:hover:bg-zinc-200",
          outline:"bg-transparent border border-zinc-300 text-zinc-900 hover:bg-zinc-50 dark:text-zinc-100 dark:border-zinc-700 dark:hover:bg-zinc-800",
          secondary:"bg-zinc-100 text-zinc-900 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-100 dark:hover:bg-zinc-700",
          ghost:"bg-transparent hover:bg-zinc-100 dark:hover:bg-zinc-800",
        };
        return <button className={`${base} ${map[variant]} ${className}`} {...p}><span className="truncate">{children}</span></button>;
      };
      const Input=(props)=>(<input {...props} className={`h-9 w-full rounded-xl border px-3 text-sm bg-white border-zinc-300 text-zinc-900 placeholder:text-zinc-400 dark:bg-zinc-900 dark:border-zinc-700 dark:text-zinc-100 dark:placeholder:text-zinc-500 ${props.className||""}`} />);
      const Badge=({children,active,onClick})=>{
        const cls=active?"bg-emerald-600 border-emerald-600 text-white":"bg-zinc-50 border-zinc-200 text-zinc-700 dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-200";
        return <span onClick={onClick} className={`text-[11px] px-2 py-1 rounded-full border select-none ${cls}`}>{children}</span>;
      };
      const Card=({title,desc,children,className=""})=> (
        <div className={`rounded-2xl overflow-hidden shadow-md ring-1 ring-black/5 dark:shadow-black/30 bg-white border border-zinc-200 dark:bg-zinc-900 dark:border-zinc-800 ${className}`}>
          {(title||desc)&&(
            <div className="border-b p-4 border-zinc-200 dark:border-zinc-800">
              {title && <div className="font-medium break-words">{title}</div>}
              {desc && <div className="text-sm text-zinc-500 dark:text-zinc-400 break-words">{desc}</div>}
            </div>
          )}
          <div className="p-4">{children}</div>
        </div>
      );
      const Section=({title,children})=>(
        <section className="space-y-4"><div className="flex items-center justify-between"><h1 className="text-lg font-semibold tracking-tight">{title}</h1></div>{children}</section>
      );
      const Icon=({name})=>{const m={LD:"üè†",EP:"üß±",LP:"üéõÔ∏è",AO:"üìà",M:"üõí"};return <span>{m[name]||"‚Ä¢"}</span>};

      const TemplatePreview=({label="Preview",tone=0})=>{
        const hue=150+(tone%6)*35, g1=`hsl(${hue},70%,55%)`, g2=`hsl(${(hue+40)%360},70%,45%)`;
        return <div className="aspect-video rounded-lg overflow-hidden border border-zinc-200 dark:border-zinc-800">
          <svg viewBox="0 0 800 450" className="w-full h-full"><defs><linearGradient id={`g${hue}`} x1="0" x2="1" y1="0" y2="1"><stop offset="0%" stopColor={g1}/><stop offset="100%" stopColor={g2}/></linearGradient></defs>
            <rect width="800" height="450" fill={`url(#g${hue})`} />
            <g fill="rgba(255,255,255,0.85)"><rect x="40" y="40" rx="16" width="280" height="160"/><rect x="340" y="40" rx="16" width="420" height="160"/><rect x="40" y="220" rx="16" width="720" height="60"/><rect x="40" y="300" rx="12" width="220" height="50"/><rect x="270" y="300" rx="12" width="220" height="50"/><rect x="500" y="300" rx="12" width="260" height="50"/></g>
            <text x="50%" y="82%" textAnchor="middle" fontFamily="ui-sans-serif,system-ui" fontSize="28" fill="rgba(0,0,0,0.55)">{label}</text>
          </svg>
        </div>;
      };

      // =============== Dados e Blocos =====================
      const MARKET_ITEMS=[
        { title:"Quiz Clima", tags:["Quiz","Escolas","Oficial"] },
        { title:"Onboarding Dev", tags:["Onboarding","Empresas","Oficial"] },
        { title:"Compliance Express", tags:["Compliance","Empresas","Oficial"] },
        { title:"Jogo de Mem√≥ria", tags:["Escolas","Fam√≠lias"] },
        { title:"Trilha de Leitura", tags:["Trilha","Fam√≠lias"] },
        { title:"Party Pack 90s", tags:["Amigos","M√∫sica"] },
      ];

      const TagPicker=({tags,active,toggle,clear})=> (
        <div className="flex flex-wrap gap-2 items-center">{tags.map(t=> <Badge key={t} active={active.includes(t)} onClick={()=>toggle(t)}>{t}</Badge>)}{active.length>0 && <Btn variant="ghost" onClick={clear}>Limpar</Btn>}</div>
      );

      const CuratedSection=({title,tags,onSeeAll,limit=4})=>{
        const list=useMemo(()=>filterByTags(MARKET_ITEMS,tags,"").slice(0,limit),[tags,limit]);
        return <Card title={title} desc={`Filtrado por: ${tags.join(", ")}`}>
          <div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-4">{list.map((it,i)=> <TemplateCard key={it.title} title={it.title} tag={it.tags[0]} idx={i}/> )}</div>
          <div className="flex justify-end mt-3"><Btn variant="outline" onClick={()=>onSeeAll&&onSeeAll(tags)}>Ver tudo ‚Üí</Btn></div>
        </Card>;
      };

      const TemplateCard=({title,tag,idx=0})=> (
        <div className="hover:shadow-lg transition-[colors,box-shadow] cursor-pointer bg-white dark:bg-zinc-900 overflow-hidden rounded-2xl ring-1 ring-black/5 dark:ring-white/5">
          <div className="p-4 border-b border-zinc-200 dark:border-zinc-800 min-w-0"><div className="flex items-center justify-between gap-2"><div className="font-medium text-sm truncate" title={title}>{title}</div><Badge>{tag}</Badge></div><div className="text-xs text-zinc-500 dark:text-zinc-400">Pronto para duplicar</div></div>
          <div className="p-4"><TemplatePreview label={title} tone={idx}/><div className="flex gap-2 mt-3"><Btn variant="secondary" className="flex-1">Duplicar</Btn><Btn className="flex-1">Usar</Btn></div></div>
        </div>
      );

      // =============== P√°ginas =====================
      const Landing=({onExplore,onStart})=> (
        <div className="grid gap-8 grid-cols-1 md:grid-cols-2 items-center min-h-[520px]">
          <div className="space-y-6 min-w-0">
            <h2 className="text-4xl md:text-5xl font-semibold leading-tight">Crie, jogue e compartilhe experi√™ncias interativas</h2>
            <p className="text-lg text-zinc-600 dark:text-zinc-400">Templates prontos, editor por blocos e analytics ‚Äî em qualquer dispositivo.</p>
            <div className="flex flex-wrap gap-3"><Btn onClick={onStart}>Come√ßar agora</Btn><Btn variant="outline" onClick={onExplore}>Explorar</Btn></div>
            <div className="flex items-center gap-3 text-sm text-zinc-600 dark:text-zinc-400"><span>‚úì</span> LGPD ‚Ä¢ Acess√≠vel ‚Ä¢ PWA</div>
          </div>
          <Card title="Preview do Editor" desc="Biblioteca, Canvas e Inspector">
            <div className="grid gap-3 min-w-0 grid-cols-1 lg:grid-cols-[220px_1fr_260px]">
              <div className="rounded-xl border p-3 space-y-2 border-zinc-200 dark:border-zinc-800 min-w-0"><div className="text-xs">Biblioteca</div>
                <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-2 gap-2 text-xs">{["Pergunta","Arrastar","Timer","M√≠dia","Branch","Invent√°rio"].map(i=> <Btn key={i} variant="secondary" className="justify-start w-full">{i}</Btn>)}</div>
              </div>
              <div className="rounded-xl border p-3 grid place-items-center text-sm text-zinc-500 dark:text-zinc-400 border-zinc-200 dark:border-zinc-800 min-w-0"><TemplatePreview label="Editor Canvas" tone={2}/></div>
              <div className="rounded-xl border p-3 space-y-2 border-zinc-200 dark:border-zinc-800 overflow-hidden min-w-0"><div className="text-xs">Inspector</div><Input placeholder="T√≠tulo"/>
                <select className="h-9 w-full rounded-xl border px-3 text-sm bg-white border-zinc-300 text-zinc-900 dark:bg-zinc-900 dark:border-zinc-700 dark:text-zinc-100"><option>Acerto</option><option>Erro</option></select>
                <div className="flex items-center justify-between text-sm gap-2"><span className="truncate">Pontua√ß√£o</span><Input className="w-20" defaultValue={10}/></div>
              </div>
            </div>
          </Card>
        </div>
      );

      const Dashboard=({goto})=> (
        <div className="space-y-6">
          <div className="flex items-end justify-between gap-4"><div><h2 className="text-xl font-semibold tracking-tight">Bem-vindo ao SparkHub</h2><p className="text-sm text-zinc-600 dark:text-zinc-400 mt-1">A√ß√µes r√°pidas e seus projetos</p></div><div className="flex gap-2"><Btn onClick={()=>goto("EDT-001")}>+ Novo projeto</Btn><Btn variant="outline" onClick={()=>goto("ANL-001")}>Resultados</Btn></div></div>
          <div className="grid gap-4 md:grid-cols-3">
            <Card title="Rodar sess√£o" desc="Crie um lobby e convide participantes"><Btn className="w-full" onClick={()=>goto("LOB-H-001")}>‚ñ∂ Criar lobby</Btn></Card>
            <Card title="Importar" desc="CSV, Sheets ou link"><Btn variant="outline" className="w-full">Importar</Btn></Card>
            <Card title="Marketplace" desc="Use e remixe conte√∫dos"><Btn variant="secondary" className="w-full" onClick={()=>goto("MKT-001")}>Abrir</Btn></Card>
          </div>
          <div className="grid gap-4 lg:grid-cols-3">
            <Card title="Meus projetos" desc="Rascunhos e publicados" className="lg:col-span-2">
              <div className="overflow-x-auto"><table className="w-full text-sm"><thead className="bg-zinc-50 dark:bg-zinc-900"><tr><th className="text-left p-2">Projeto</th><th className="text-left p-2">Status</th><th className="text-left p-2">Atualizado</th><th className="text-right p-2">A√ß√µes</th></tr></thead><tbody>
                {[ ["Aula de Ecossistemas","Rascunho","h√° 2 dias"],["Onboarding Seguran√ßa","Publicado","h√° 1 semana"] ].map(([n,s,u])=> (
                  <tr key={n} className="border-t border-zinc-200 dark:border-zinc-800"><td className="p-2">{n}</td><td className="p-2">{s==="Publicado"? <Badge>Publicado</Badge> : <Badge>Rascunho</Badge>}</td><td className="p-2">{u}</td><td className="p-2 text-right"><div className="inline-flex gap-2"><Btn variant="outline">Editar</Btn><Btn>Publicar</Btn></div></td></tr>
                ))}</tbody></table></div>
            </Card>
            <Card title="Pr√≥ximas sess√µes" desc="Esta semana">
              {["Turma 2B ‚Äì Ecossistemas","Treinamento LGPD"].map((t,i)=> (
                <div key={t} className="flex items-center justify-between border rounded-xl p-3 mb-2 border-zinc-200 dark:border-zinc-800"><div className="min-w-0"><div className="font-medium text-sm truncate max-w-[220px]" title={t}>{t}</div><div className="text-xs text-zinc-600 dark:text-zinc-400">{i?"Amanh√£ 10:00":"Hoje 14:00"}</div></div><Btn variant="secondary">Abrir</Btn></div>
              ))}
            </Card>
          </div>
        </div>
      );

      const Editor=({goto})=> (
        <div className="space-y-3">
          <div className="flex items-center justify-between"><div className="flex items-center gap-2"><Badge>EDT-001</Badge><div className="text-sm text-zinc-600 dark:text-zinc-400">Editor por Blocos</div></div><div className="flex gap-2"><Btn variant="secondary">Salvar</Btn><Btn variant="outline" onClick={()=>goto("PLY-G-001")}>Testar</Btn><Btn onClick={()=>goto("PUB-001")}>Publicar</Btn></div></div>
          <div className="grid gap-3 min-h-[540px] grid-cols-1 lg:grid-cols-[240px_1fr_300px]">
            <div className="rounded-xl border p-3 border-zinc-200 dark:border-zinc-800"><div className="text-xs mb-2">Biblioteca</div>
              {[ ["Pergunta de m√∫ltipla escolha","Blocks"],["Arrastar e soltar","Intera√ß√£o"],["Timer","Utilit√°rios"],["M√≠dia (imagem/v√≠deo)","Conte√∫do"] ].map(([t,cat])=> (
                <div key={t} className="rounded-xl border p-2 mb-2 border-zinc-200 dark:border-zinc-800 shadow-sm dark:shadow-black/20"><div className="text-sm break-words">{t}</div><div className="text-[11px] text-zinc-600 dark:text-zinc-400">{cat}</div></div>
              ))}
            </div>
            <div className="rounded-xl border p-3 grid gap-3 border-zinc-200 dark:border-zinc-800">
              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">{[1,2,3].map(i=> <Card key={i} title={`Tela ${i}`} desc="Arraste componentes aqui" className="min-w-0"><div className="text-xs text-zinc-500 dark:text-zinc-400">(drop zone)</div></Card>)}</div>
              <div className="flex items-center justify-center"><Btn variant="secondary">+ Nova tela</Btn></div>
            </div>
            <div className="rounded-xl border p-3 space-y-3 border-zinc-200 dark:border-zinc-800 overflow-hidden"><div className="text-xs">Inspector</div>
              <div className="grid gap-2"><div className="text-xs">T√≠tulo</div><Input placeholder="Pergunta 1"/></div>
              <div className="grid gap-2"><div className="text-xs">Feedback</div><select className="h-9 w-full rounded-xl border px-3 text-sm bg-white border-zinc-300 text-zinc-900 dark:bg-zinc-900 dark:border-zinc-700 dark:text-zinc-100"><option>Imediato</option><option>Ao final</option></select></div>
              <div className="flex items-center justify-between gap-2"><div className="text-xs">Pontua√ß√£o</div><Input defaultValue={10} className="w-20"/></div>
            </div>
          </div>
        </div>
      );

      const Publish=()=> (
        <Card title="Publicar & Compartilhar" desc="Defina t√≠tulo, privacidade e compartilhamento">
          <div className="grid gap-4 md:grid-cols-2">
            <div className="space-y-3"><div>T√≠tulo</div><Input defaultValue="Aula de Ecossistemas"/><div>Privacidade</div>
              <select className="h-9 w-full rounded-xl border px-3 text-sm bg-white border-zinc-300 text-zinc-900 dark:bg-zinc-900 dark:border-zinc-700 dark:text-zinc-100"><option>P√∫blico</option><option>Privado (link)</option><option>Somente organiza√ß√£o</option></select>
              <div className="flex gap-2 pt-2"><Btn>Gerar link</Btn><Btn variant="outline">Marketplace</Btn></div>
            </div>
            <div className="space-y-3"><div>Formas de acesso</div>
              <div className="grid gap-2">
                <div className="flex items-center justify-between rounded-xl border p-3 border-zinc-200 dark:border-zinc-800"><div className="text-sm">C√≥digo da sala: <strong>483‚Äë921</strong></div><Btn variant="secondary">Copiar</Btn></div>
                <div className="flex items-center justify-between rounded-xl border p-3 border-zinc-200 dark:border-zinc-800"><div className="text-sm">Link de acesso</div><Btn variant="secondary">Copiar</Btn></div>
                <div className="flex items-center justify-between rounded-xl border p-3 border-zinc-200 dark:border-zinc-800"><div className="text-sm">Embed &lt;iframe&gt;</div><Btn variant="outline">Obter</Btn></div>
              </div>
            </div>
          </div>
        </Card>
      );

      const Lobby=({goto})=> (
        <Card title="Lobby do Host" desc={<span>C√≥digo <strong>483‚Äë921</strong> ‚Ä¢ 12 participantes</span>}>
          <div className="flex items-center justify-between gap-4 flex-wrap"><div className="flex items-center gap-3"><Btn>Iniciar</Btn><Btn variant="outline">Pausar</Btn><Btn variant="secondary">Silenciar</Btn></div><div className="text-sm text-zinc-600 dark:text-zinc-400">Ana, Jo√£o e outros</div><Btn variant="outline" onClick={()=>goto("ANL-001")}>Resultados</Btn></div>
        </Card>
      );
      const PlayerJoin=()=> (<div className="grid place-items-center"><Card title="Entrar" desc="Digite o c√≥digo" className="w-[380px]"><div className="space-y-3"><Input placeholder="C√≥digo"/><Btn className="w-full">Entrar</Btn></div></Card></div>);
      const PlayerGame=()=> (<div className="grid place-items-center"><Card title="Pergunta 1" desc="Qual √© um bioma brasileiro?" className="w-[420px]"><div className="grid gap-2">{["Tundra","Caatinga","Taiga","Alpes"].map(o=> <Btn key={o} variant="secondary" className="justify-start">{o}</Btn>)}<div className="text-xs text-zinc-600 dark:text-zinc-400 pt-2">00:23</div></div></Card></div>);

      // ======= Gr√°fico com anima√ß√£o (fade + line-draw) =======
      const LineChartSVG=({data=[]})=>{
        const w=800,h=240,p=24; const pathStr=data.map((d,i)=>{const x=p+d.x*(w-p*2), y=h-p-d.y*(h-p*2);return `${i?"L":"M"}${x.toFixed(1)},${y.toFixed(1)}`}).join(" ");
        const area=`${pathStr} L ${w-p},${h-p} L ${p},${h-p} Z`;
        const lineRef=useRef(null); const [dash,setDash]=useState({a:0,o:0}); const [visible,setVisible]=useState(false);
        useEffect(()=>{ const el=lineRef.current; if(!el) return; const len=el.getTotalLength(); el.style.strokeDasharray=`${len}`; el.style.strokeDashoffset=`${len}`; requestAnimationFrame(()=>{ setDash({a:len,o:0}); setVisible(true); el.style.transition="stroke-dashoffset 900ms ease"; el.style.strokeDashoffset="0"; }); },[pathStr]);
        return <svg viewBox={`0 0 ${w} ${h}`} className="w-full h-[220px] text-emerald-600 dark:text-emerald-400">
          <defs><linearGradient id="lineFill" x1="0" x2="0" y1="0" y2="1"><stop offset="0%" stopColor="currentColor" stopOpacity=".35"/><stop offset="100%" stopColor="currentColor" stopOpacity="0"/></linearGradient></defs>
          <rect width={w} height={h} fill="transparent"/>
          <g strokeWidth="1" stroke="currentColor" opacity=".15">{[0,1,2,3,4].map(i=> <line key={i} x1={p} x2={w-p} y1={p+(i*(h-2*p))/4} y2={p+(i*(h-2*p))/4}/> )}</g>
          <path d={area} fill="url(#lineFill)" style={{opacity:visible?1:0, transition:"opacity 700ms ease"}}/>
          <path ref={lineRef} d={pathStr} fill="none" stroke="currentColor" strokeWidth="2" strokeDasharray={dash.a} strokeDashoffset={dash.o}/>
        </svg>;
      };
      const Analytics=()=>{ const mock=Array.from({length:12},(_,i)=>({x:i/11,y:(0.5+0.4*Math.sin((i/11)*Math.PI*2))})); return (
        <div className="grid gap-4 lg:grid-cols-3"><Card title="Engajamento por sess√£o" desc="Tempo e acerto" className="lg:col-span-2"><div className="rounded-xl border border-dashed p-3 h-auto border-zinc-300 dark:border-zinc-700"><LineChartSVG data={mock}/></div></Card><Card title="KPIs" desc="Vis√£o r√°pida"><div className="space-y-3">{[["Engajamento","m√©dia mensal","78%"],["Acerto m√©dio","todas as sess√µes","62%"],["Tempo m√©dio","por participante","9m"]].map(([t,s,v])=> (<div key={t} className="rounded-xl border p-3 flex items-center justify-between border-zinc-200 dark:border-zinc-800 shadow-sm dark:shadow-black/20"><div><div className="text-sm">{t}</div><div className="text-xs text-zinc-600 dark:text-zinc-400">{s}</div></div><div className="text-xl font-semibold">{v}</div></div>))}</div></Card></div>
      )};
      const Org=()=> (
        <Card title="Organiza√ß√£o ‚Äî Escola Alfa" desc="Turmas, membros e permiss√µes"><div className="grid gap-4 md:grid-cols-2"><div className="space-y-2"><div>Turmas/Times</div><div className="grid gap-2">{["2A","2B","RH","Fam√≠lia Silva"].map(n=> <Btn key={n} variant="outline" className="justify-between">{n}<span>‚Üí</span></Btn>)}</div></div><div className="space-y-2"><div>Membros</div><div className="overflow-x-auto"><table className="w-full text-sm"><thead className="bg-zinc-50 dark:bg-zinc-900"><tr><th className="text-left p-2">Nome</th><th className="text-left p-2">Papel</th><th className="text-left p-2">Status</th></tr></thead><tbody><tr className="border-t border-zinc-200 dark:border-zinc-800"><td className="p-2">Ana</td><td className="p-2">Facilitadora</td><td className="p-2"><Badge>Ativo</Badge></td></tr><tr className="border-t border-zinc-200 dark:border-zinc-800"><td className="p-2">Jo√£o</td><td className="p-2">Estudante</td><td className="p-2"><Badge>Pendente</Badge></td></tr></tbody></table></div></div></div></Card>
      );

      // =============== Marketplace =====================
      const Marketplace=({title="Marketplace",initialTags,initialTab})=>{
        const [search,setSearch]=useState(""), [active,setActive]=useState(initialTags||[]), [tab,set]=useState(initialTab||read("sparkhub_market_tab","destaques"));
        useEffect(()=>{ if(tab==="todos"){ const intent=JSON.parse(read("sparkhub_market_tags","[]")); if(intent.length) setActive(intent);} },[tab]);
        useEffect(()=>persist("sparkhub_market_tab",tab),[tab]);
        const allTags=useMemo(()=>{const s=new Set(); MARKET_ITEMS.forEach(it=>it.tags.forEach(t=>s.add(t))); return Array.from(s).sort();},[]);
        const results=useMemo(()=>filterByTags(MARKET_ITEMS,active,search),[active,search]);
        const toggle=t=> setActive(cur=> cur.includes(t)? cur.filter(x=>x!==t): [...cur,t]);
        return (<div className="space-y-4">
          <div className="flex items-end justify-between gap-4"><div><h2 className="text-xl font-semibold tracking-tight">{title}</h2><p className="text-sm text-zinc-600 dark:text-zinc-400">Use, remixe e publique conte√∫dos</p></div>{tab==="todos"&& <Input placeholder="Buscar" className="w-64" value={search} onChange={e=>setSearch(e.target.value)}/>}</div>
          <div className="flex items-center gap-2"><Btn variant={tab==="destaques"?"secondary":"ghost"} onClick={()=>set("destaques")}>Destaques</Btn><Btn variant={tab==="todos"?"secondary":"ghost"} onClick={()=>set("todos")}>Todos</Btn></div>
          {tab==="destaques"? (<div className="space-y-4">
            <CuratedSection title="Destaques Oficiais" tags={["Oficial"]} onSeeAll={(tags)=>{persist("sparkhub_market_tags",JSON.stringify(tags)); set("todos");}}/>
            <CuratedSection title="Para Escolas" tags={["Escolas"]} onSeeAll={(tags)=>{persist("sparkhub_market_tags",JSON.stringify(tags)); set("todos");}}/>
            <CuratedSection title="Empresas" tags={["Empresas"]} onSeeAll={(tags)=>{persist("sparkhub_market_tags",JSON.stringify(tags)); set("todos");}}/>
            <CuratedSection title="Fam√≠lia & Amigos" tags={["Fam√≠lias","Amigos"]} onSeeAll={(tags)=>{persist("sparkhub_market_tags",JSON.stringify(tags)); set("todos");}}/>
          </div>) : (<>
            <TagPicker tags={allTags} active={active} toggle={toggle} clear={()=>setActive([])}/>
            <div className="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">{results.map((it,i)=> <TemplateCard key={it.title} title={it.title} tag={it.tags[0]} idx={i}/>)}{results.length===0&& <Card title="Nada encontrado" desc="Ajuste os filtros ou a busca"/>}</div>
          </>)}
        </div>);
      };

      // =============== P√°ginas MESCLADAS =====================
      const CombinedLD=({appGoto})=>{ const [tab,set]=useState("dashboard"); useEffect(()=>persist("sparkhub_ld_tab",tab),[tab]); const goMkt=()=>appGoto("MKT-001"); const dashGoto=(d)=>{ if(d==="EDT-001"){ persist("sparkhub_ep_tab","editor"); appGoto("EP-PUB"); } else if(d==="ANL-001"){ persist("sparkhub_ao_tab","analytics"); appGoto("ANL-ORG"); } else if(d==="LOB-H-001"){ persist("sparkhub_lp_tab","lobby"); appGoto("LOB-PLY"); } else if(d==="MKT-001"){ appGoto("MKT-001"); } };
        return <div className="space-y-4"><div className="flex items-center gap-2"><Btn variant={tab==="landing"?"secondary":"ghost"} onClick={()=>set("landing")}>In√≠cio</Btn><Btn variant={tab==="dashboard"?"secondary":"ghost"} onClick={()=>set("dashboard")}>Painel</Btn></div>{tab==="landing"? <Landing onExplore={goMkt} onStart={()=>set("dashboard")}/> : <Dashboard goto={dashGoto}/>}</div>;
      };
      const CombinedEP=({appGoto})=>{ const [tab,set]=useState(read("sparkhub_ep_tab","editor")); useEffect(()=>persist("sparkhub_ep_tab",tab),[tab]); const edGoto=(d)=>{ if(d==="PLY-G-001"){ persist("sparkhub_lp_tab","player"); appGoto("LOB-PLY"); } if(d==="PUB-001"){ set("publicar"); persist("sparkhub_ep_tab","publicar"); } };
        return <div className="space-y-4"><div className="flex items-center gap-2"><Btn variant={tab==="editor"?"secondary":"ghost"} onClick={()=>set("editor")}>Editor</Btn><Btn variant={tab==="publicar"?"secondary":"ghost"} onClick={()=>set("publicar")}>Publicar</Btn></div>{tab==="editor"? <Editor goto={edGoto}/> : <Publish/>}</div>;
      };
      const CombinedLP=({appGoto})=>{ const [tab,set]=useState(read("sparkhub_lp_tab","lobby")); useEffect(()=>persist("sparkhub_lp_tab",tab),[tab]); const lbGoto=(d)=>{ if(d==="ANL-001"){ persist("sparkhub_ao_tab","analytics"); appGoto("ANL-ORG"); } };
        return <div className="space-y-4"><div className="flex items-center gap-2"><Btn variant={tab==="lobby"?"secondary":"ghost"} onClick={()=>set("lobby")}>Lobby</Btn><Btn variant={tab==="join"?"secondary":"ghost"} onClick={()=>set("join")}>Entrar</Btn><Btn variant={tab==="player"?"secondary":"ghost"} onClick={()=>set("player")}>Jogo</Btn></div>{tab==="lobby"&&<Lobby goto={lbGoto}/>} {tab==="join"&&<PlayerJoin/>} {tab==="player"&&<PlayerGame/>}</div>;
      };
      const CombinedAO=()=>{ const [tab,set]=useState(read("sparkhub_ao_tab","analytics")); const [akey,setAkey]=useState(0); useEffect(()=>persist("sparkhub_ao_tab",tab),[tab]); return <div className="space-y-4"><div className="flex items-center gap-2"><Btn variant={tab==="analytics"?"secondary":"ghost"} onClick={()=>{set("analytics"); setAkey(k=>k+1);}}>Resultados</Btn><Btn variant={tab==="organizacoes"?"secondary":"ghost"} onClick={()=>set("organizacoes")}>Organiza√ß√µes</Btn></div>{tab==="analytics"? <Analytics key={akey}/> : <Org/>}</div>; };

      // =============== Shell/App =====================
      const Sidebar=({current,onNav,isDark,onToggleTheme,collapsed,setCollapsed,mobileOpen,setMobileOpen})=>{
        const items=[["LD-DSH","Hub","LD"],["EP-PUB","Cria√ß√£o","EP"],["LOB-PLY","Sess√£o","LP"],["ANL-ORG","Resultados","AO"],["MKT-001","Marketplace","M"]];
        const Side=(
          <aside className={`h-full shrink-0 border-r p-3 space-y-2 transition-[width,colors] bg-white border-zinc-200 dark:bg-zinc-950 dark:border-zinc-800 ${collapsed?"w-[68px]":"w-[240px]"}`}>
            <div className="flex items-center gap-2 mb-2"><div className="h-8 w-8 rounded-2xl grid place-items-center bg-emerald-600 text-white font-semibold">S</div>{!collapsed&&<div className="font-semibold truncate">SparkHub</div>}</div>
            <Btn variant="outline" className="w-full" onClick={()=>setCollapsed(v=>!v)}>{collapsed?"‚Üí":"‚Üê"} {!collapsed&&"Recolher"}</Btn>
            <div className="grid gap-1">{items.map(([key,label,ic])=> (
              <Btn key={key} variant={current===key?"secondary":"ghost"} className="w-full justify-start" onClick={()=>{onNav(key); setMobileOpen(false);}}><span className="w-5 text-center"><Icon name={ic}/></span>{!collapsed&&<span className="truncate">{label}</span>}</Btn>
            ))}</div>
            <div className="my-2 border-t border-zinc-200 dark:border-zinc-800"/>
            <Btn variant="outline" className="w-full" onClick={onToggleTheme}>Tema: {isDark?"Escuro":"Claro"}</Btn>
            <Btn variant="outline" className="w-full">Gerar link</Btn>
          </aside>
        );
        return (<>
          <div className="hidden lg:block">{Side}</div>
          {mobileOpen && (
            <div className="lg:hidden fixed inset-0 z-50"><div className="absolute inset-0 bg-black/40" onClick={()=>setMobileOpen(false)}/><div className="absolute inset-y-0 left-0 w-[300px]">{Side}</div></div>
          )}
        </>);
      };

      // =============== App =====================
      function SparkHubPreview(){
        const [frame,setFrame]=useState("LD-DSH"), [isDark,setDark]=useState(false), [collapsed,setCollapsed]=useState(false), [mobileOpen,setMobileOpen]=useState(false);
        useEffect(()=>{ const saved = read("sparkhub_theme", null); if (saved === "dark") setDark(true); else if (saved === "light") setDark(false); else { try { const prefers = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches; setDark(!!prefers); } catch { setDark(false); } } },[]);
        useEffect(()=>{ persist("sparkhub_theme", isDark?"dark":"light"); try { const root = document.documentElement; if (isDark) root.classList.add('dark'); else root.classList.remove('dark'); } catch {} },[isDark]);
        useEffect(()=>{
          console.assert(typeof Marketplace === 'function', 'Marketplace deve estar definido');
          console.assert(Array.isArray(MARKET_ITEMS) && MARKET_ITEMS.length>0, 'MARKET_ITEMS deve ter itens');
          const f=filterByTags([{title:'x',tags:['a']}],['a'],'');
          console.assert(f.length===1,'filterByTags deve filtrar corretamente');
        },[]);
        const appGoto=(k)=>setFrame(k);
        return (
          <div className={`${isDark?"dark":""}`}>
            <div className="min-h-[760px] bg-zinc-50 text-zinc-900 dark:bg-zinc-900 dark:text-zinc-100 flex overflow-x-hidden">
              <Sidebar current={frame} onNav={setFrame} isDark={isDark} onToggleTheme={()=>setDark(v=>!v)} collapsed={collapsed} setCollapsed={setCollapsed} mobileOpen={mobileOpen} setMobileOpen={setMobileOpen}/>
              <main key={frame} className="flex-1 p-4 sm:p-6 w-full min-w-0">
                <div className="lg:hidden mb-4"><Btn variant="outline" onClick={()=>setMobileOpen(true)}>‚ò∞ Menu</Btn></div>
                {frame==="LD-DSH" && <Section title="Hub"><CombinedLD appGoto={appGoto}/></Section>}
                {frame==="EP-PUB" && <Section title="Cria√ß√£o"><CombinedEP appGoto={appGoto}/></Section>}
                {frame==="LOB-PLY" && <Section title="Sess√£o"><CombinedLP appGoto={appGoto}/></Section>}
                {frame==="ANL-ORG" && <Section title="Resultados"><CombinedAO/></Section>}
                {frame==="MKT-001" && <Section title="Marketplace"><Marketplace/></Section>}
              </main>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<SparkHubPreview />);
    </script>
  </body>
</html>
